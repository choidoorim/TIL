# 1. 실행 컨텍스트란?

실행 컨텍스트는 **실행할 코드에 제공할 환경 정보들을 모아놓은 객체**로, 자바스크립트의 동적 언어로서의 특징을 가장 잘 파악할 수 있는 개념이다.

실행 컨텍스트를 이해하기 위해서는 스택과 큐를 알고 있어야 한다.

- 스택: 후입선출
- 큐: 선입선출

**동일한 환경**에 있는 코드들을 실행할 때 필요한 환경 정보들을 모아 컨텍스트를 구성하고, 이를 콜스택에 쌓아올렸다가 가장 위에 쌓여있는 컨텍스트와 관련있는 코드들을 실행시키는 방식으로 전체코드의 환경과 순서를 보장한다.

- 동일한 환경: 하나의 실행 컨텍스트를 구성할 수 있는 방법으로 전역공간, eval() 함수, 함수 등이 있다.

자동으로 생성되는 전역공간과 악마로 취급받는 `eval` 를 제외하고는 우리가 흔히 **실행컨텍스트를 구성하는 방법은 함수를 실행하는 것**뿐이다.

```jsx
// (1)
var a = 1;

function outer() {
  function inner() {
    console.log(a); // undefined
    var a = 3;
  }
  inner(); // (2)
  console.log(a); // 1
}
outer(); // (3)
console.log(a); // 1
```

자바스크립트를 실행하는 순간(1) 전역 컨텍스트가 콜 스택에 담긴다.

전역 컨텍스트에 관련된 코드를 실행하다가 (3) 에서 outer 함수를 호출하면 자바스크립트는 outer 함수에 대한 환경을 수집해서 outer 실행 컨텍스트를 생성한 후 콜스택에 담는다. 콜스택의 맨 위에 outer 실행 컨텍스트가 놓인 상태가 됐으므로 전역 컨텍스트와 관련된 코드들의 실행을 일시중단하고 대신 outer 실행 컨텍스트와 관련된 코드, 즉 outer 함수 내부의 코드들을 순차적으로 실행한다.

outer 컨텍스트를 실행하다가 (2)에서 inner 함수의 실행컨텍스트가 콜스택의 가장 상위에 담기면 outer 실행 컨텍스트와 관련된 코드를 일시중단하고 inner 함수 내부코드를 실행할 것이다.

inner 함수가 모두 실행되면 inner 실행 컨텍스트는 콜스택에서 사라진다. 그러면 아래있던 outer 실행 컨텍스트가 제일 상단에 위치하게 되므로 중단되었던 (2) 의 다음 줄부터 실행된다. outer 함수가 종료되고 outer 실행 컨텍스트가 사라지게되면 중단되었던 (3) 부터 다시 시작되게 된다. 모든 코드가 실행되어 실행할 코드가 존재하지 않는다면 전역 컨텍스트도 제거되고, 콜스택에는 아무것도 남지 않는 상태로 종료된다.

![%E1%84%8B%E1%85%B5%E1%84%85%E1%85%B3%E1%86%B7_%E1%84%8B%E1%85%A5%E1%86%B9%E1%84%82%E1%85%B3%E1%86%AB_%E1%84%82%E1%85%A9%E1%84%90%E1%85%B3%E1%84%87%E1%85%AE%E1%86%A8-2_2](https://user-images.githubusercontent.com/63203480/218483984-2fbe8c30-2128-4c60-8d80-8966d06ec9e1.jpg)


하나의 실행 컨텍스트가 콜 스택의 상단에 쌓이는 시점이 현재 코드에 관여하게 되는 시점인 것을 알 수 있다. 어떤 **실행 컨텍스트가 활성화 될 때 자바스크립트 엔진은 해당 컨텍스트에 관련된 코드들을 실행하는데 필요한 환경 정보들을 수집해서 실행 컨텍스트 객체에 저장**한다. 엔진 자체에서 활용할 목적으로 만들어진 객체이기 때문에 일반 사용자, 개발자는 코드를 통해 확인할 수가 없다.

- VariableEnvironment: 현재 컨텍스트 내부의 식별자들에 대한 정보 + 외부 환경 정보, 선언시점의 LexicalEnvironment 의 스냅샷으로, 변경 사항은 반영되지 않는다.
- LexicalEnvironment: 처음에는 VariableEnvironment 와 같지만, 변경사항이 실시간으로 반영된다.
- ThisBinding: this 식별자가 바라봐야 할 대상 객체

<img width="371" alt="스크린샷 2023-03-05 오전 2 15 43" src="https://user-images.githubusercontent.com/63203480/222919671-92dac7e5-75fc-4c13-95a3-8b7ee1f6da2c.png">

