# 11-1. CPU 스케쥴링 개요

- 운영체제가 **프로세스들 간에 공정하고 합리적으로 CPU 자원을 배분하는 것**을 CPU 스케쥴링이라고 한다.

## 프로세스 우선순위

- 프로세스마다 빨리 처리해야 하는 우선순위를 가지고 있다.
- 대부분의 프로세스는 CPU 와 입출력 장치를 모두 사용하며 실행한다. 즉, 프로세스는 실행상태와 대기 상태를 반복하면서 실행한다.
    - 워드 프로세서는 CPU 를 사용하여 명령어를 실행하고, 사용자로부터 입력받은 내용을 보조기억장치에 저장하고, CPU 를 사용하여 명령어를 실행하고, 사용자가 입력한 내용을 화면에 출력하는 과정을 반복하여 실행한다.
- 프로세스의 종류마다 입출력장치를 이용하는 시간과 CPU 를 이용하는 시간의 양에는 차이가 있다. 디스크 백업, 비디오 재생 등 **입출력 작업이 많은 프로세스를 입출력 집중 프로세스**라고 하고, 연산 작업이 많은 **CPU 작업이 많은 프로세스를 CPU 집중 프로세스**라고 한다.
- 입출력 집중 프로세스는 실행 상태보다는 대기 상태에 많이 머무르고, CPU 집중 프로세스는 대기 상태보다는 실행 상태에 더 많이 머무른다.
- CPU 를 이용하는 작업을 CPU 버스트, 입출력 장치를 기다리는 작업을 입출력 버스트라고 부른다.
- CPU 집중 프로세스와 입출력 작업 프로세스가 동시에 CPU 의 자원을 요구했을 때 운영체제는 CPU 사용 시간이 짧은 입출력 작업 프로세스를 먼저 실행 한 뒤, CPU 집중 프로세스에게 CPU 를 할당하는 것이 더 효율적이다. 이렇게 프로세스의 중요도에 맞게 프로세스가 CPU 를 이용할 수 있도록 하기 위해 운영체제는 프로세스마다 우선 순위를 부여한다.

## 스케쥴링 큐

![Untitled](https://github.com/choidoorim/programing-books/assets/63203480/2f7f77a1-dc4b-4b14-9748-308c11e1fc7f)

- 운영체제가 PCB 에 있는 우선순위를 찾기 위해서 모든 프로세스를 검사하는 것은 오래걸리고, 비효율적이기 때문에 **운영체제는 프로세스들에 줄을 서서 기다리는 것을 요구**한다. 그리고 운영체제는 이 줄을 스케쥴링 큐로 구현하고 관리한다.
    - 운영체제는 메모리에 적재되는 프로세스, CPU를 이용하고 싶은 프로세스, 특정 입출력 장치를 이용하고 싶은 프로세스 등을 큐에 삽입하여 줄을 세운다.
- 운영체제가 관리하는 대부분의 자원을 큐로 관리된다. 그리고 큐에는 다양한 종류가 있는데 준비 큐와 대기 큐가 있다. **준비 큐는 CPU 를 이용하고 싶은 프로세스**들이 들어가고, **대기 큐는 입출력 장치를 이용하기 위해 대기 상태에 접어든 프로세스**들이 들어간다.
- 준비 상태에 있는 프로세스들의 PCB 는 준비 큐의 마지막에 삽입되어서 CPU 를 사용할 차례를 기다린다. 운영체제는 큐에 삽입되어 있는 순서대로 프로세스를 하나씩 꺼내서 실행하되, 그중 우선순위가 높은 프로세스를 먼저 실행한다.
- 대기 상태에 있는 프로세스는 같은 장치를 요구한 프로세스들은 같은 대기 큐에서 기다린다. 입출력이 완료되어 완료 인터럽트가 발생하면 운영체제는 대기 큐에서 작업이 완료된 PCB 를 찾고, PCB 를 준비상태로 변경 후 대기 큐에서 제거하고 해당 PCB 는 준비 큐로 이동한다.

## 선점형과 비선점형 스케쥴링

- 다른 급한 프로세스가 있을 경우 CPU 를 강제로 빼앗는 경우 선점형 스케쥴링, CPU 를 사용하고 있는 프로세스가 끝날 때까지 기다리게 하는 것을 비선점형 스케쥴링이라고 한다.

### 선점형(preemptive) 스케쥴링

- 프로세스가 CPU 와 자원들을 사용하고 있더라도 운영체제가 프로세스로부터 자원을 강제로 빼앗아 다른 프로세스에게 할당해주는 스케쥴링 방식이다. 즉, 독점할 수 없는 스케쥴링 방식이다.
- 프로세스 별로 정해진 시간만큼 CPU 를 사용하고, 정해진 시간이 초과한다면 운영체제가 해당 프로세스로부터 CPU 자원을 빼앗아 다음 프로세스에게 할당하는 방식이다.

### 비선점형(non-preemptive) 스케쥴링

- 하나의 프로세스가 자원을 사용하고 있다면 해당 프로세스가 종료되거나 스스로 대기상태로 넘어가기 전까지는 다른 프로세스가 끼어들 수 없는 스케쥴링 방식이다. 즉, 하나의 프로세스가 자원을 독점할 수 있는 스케쥴링 방식이다.

### 장단점

- 선점형 스케쥴링은 프로세스의 자원 독점을 막고 골고루 자원을 배분할 수 있지만, 비선점형 스케쥴링은 프로세스마다 골고루 자원을 배분하지 못한다.
- 선점형 스케쥴링은 골고루 자원을 배분하는 만큼, 문맥교환 과정에서 오버헤드가 발생한다. 하지만 비선점형 스케쥴링은 선점형 스케쥴링에 비해 문맥 교환의 횟수가 적기 때문에 비교적 오버헤드가 적게 발생한다.
    - 오버헤드: 기존 보다 추가적으로 시간, 자원, 메모리 등이 사용되는 현상
