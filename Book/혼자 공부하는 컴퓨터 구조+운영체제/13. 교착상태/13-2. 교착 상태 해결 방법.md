# 13-2. 교착 상태 해결 방법

## 교착 상태 예방

- 프로세스들에 자원을 할당할 때 상호 배제, 점유와 대기, 비선점, 원형 대기중 하나의 조건이라도 만족시키지 않게 할당한다면 교착 상태는 발생하지 않는다.
- 상호 배제를 없앤다는 것은 모든 자원을 공유가능하도록 한다는 것이다.
- 점유와 대기를 없앤다는 것은 특정 프로세스에 자원을 모두 할당하거나, 아예 할당하지 않는 방식으로 배분한다. 단점도 있는데, 당장 자원이 필요하지만 기다려야 하는 상황이 발생하거나 오랫동안 자원이 할당되기 때문에 자원의 활용률이 낮다.
- 비선점을 없애면 자원을 이용 중인 프로세스로부터 해당 자원을 강제로 빼앗을 수 있다. 하지만 모든 자원이 선점 가능하지는 않기 때문에 비선점 조건을 없애는 것은 범용성이 떨어진다.
    - 예를 들면 프린터 자원을 이용하고 있는 중에는 다른 프로세스가 프린터 자원을 빼앗아 사용하는 것은 힘들다.
- 원형 대기 조건을 없애는 방법은 모든 자원에 번호를 붙이고, 오름차순으로 자원을 할당하면 된다. 하지만 단점으로는 모든 컴퓨터 시스템에 번호를 붙이는 것은 간단한 작업이 아니며, 어떤 번호를 붙이는지에 따라 특정 자원의 활용률이 떨어질 수 있다.

  ![Untitled](https://github.com/choidoorim/programing-books/assets/63203480/18c0a82b-51cd-47e7-ae21-68f51ce3f310)


## 교착 상태 회피

- 교착 상태가 발생하지 않을 정도로만 자원을 할당하는 방식이다.
- 교착 상태는 모든 프로세스들이 한 번에 많은 자원을 요규하면 교착 상태가 발생할 위험이 증가한다.
- 교착 상태가 발생하지 않고 모든 프로세스가 정상적으로 자원을 할당받고 종료될 수 있는 상태를 안전 상태라고 하고, 교착 상태가 발생할 수도 있는 상황을 불안정 상태라고 한다.
- 안전 순서열(safe sequence)이란 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서를 의미한다. 그리고 안전 순서열대로 프로세스들에 자원을 배분해서 교착상태가 발생하지 않는 상태를 안전 상태라고 한다.
- 불안정 상태란 안전 순서열이 없는 상태를 의미한다. 그리고 시스템이 불안전 상태에 놓인다면 교착 상태가 발생할 수 있는 위험이 있다.
- 교착 상태 회피 방식은 항상 안전 상태를 유지하도록 자원을 할당하는 방식이다.

## 교착 상태 검출 후 회복

- 교착 상태의 발생을 인정하고 사후 조치하는 방식이다.
- 선점을 통한 회복, 프로세스 강제 종료를 통한 회복 방식으로 교착 상태 검출 후 회복을 한다.

### 선점을 통한 회복

- 교착 상태가 해결될 때까지 한 프로세스씩 자원을 몰아주는 방식이다.

### 프로세스 강제 종료를 통한 회복

- 단순하고 확실한 방법으로 교착 상태에 놓인 프로세스를 모두 강제 종료하거나, 교착 상태가 없어질 때까지 한 프로세스씩 강제 종료할 수 있다.
- 많은 프로세스가 작업 내역을 잃게 될 가능성이 있고, 작업 내역을 잃는 프로세스를 최대한 줄여도 교착 상태가 없어졌는지 여부를 확인하는 과정에서 오버헤드를 야기한다.
- 드물게 발생하는 잠재적 교착 상태를 무시하는 대처방식으로 타조 알고리즘(ostrich algorithm) 도 있다.
