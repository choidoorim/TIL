# 6-2. 메모리의 주소 공간

## 물리 주소와 논리 주소

- CPU 와 실행 중인 프로그램은 메모리 몇 번지에 무엇이 저장되어 있는지 모를 뿐더러, 같은 프로그램을 실행해도 실행할 때 마다 적재되는 주소가 달리질 수 있다.
- 메모리가 사용하는 **물리 주소는 실제로 저장된 하드웨어 상의 주소를 의미**한다.
- CPU 와 실행 중인 프로그램이 사용하는 **논리 주소는 실행 중인 프로그램 각각 에게 부여된 0 번지부터 시작되는 주소**를 의미한다. CPU 는 논리 주소를 받아들이고, 해석하고, 연산한다.
- CPU 가 이해하는 주소가 논리 주소지만, CPU 가 메모리와 상호작용하려면 논리 주소와 물리 주소 간의 변환이 이뤄져야 한다. 만약 변환이 이뤄지지 않는다면 CPU 와 메모리는 서로 이해할 수 없는 주소 체계를 갖기 때문에 상호작용할 수 없다. **논리 주소와 물리 주소 간의 변환은 CPU 와 주소 버스 사이에 위치한 메모리 관리 장치(MMU: Memory Management Unit) 라는 하드웨어에 의해 수행**된다.

  ![operating_system](https://github.com/choidoorim/TIL/assets/63203480/5f3d1917-a8df-44dd-aeaf-06c89b391b91)

  “논리주소 + 베이스 레지스터(346 + 14000)” 를 통해 논리 주소를 물리 주소(14346)로 변환한다. 물리 주소 14000 번지부터 적재된 프로그램 A 의 논리 주소 346 번지에는 이런식으로 접근하는 것이다.

- 베이스레지스터는 프로그램의 가장 작은 물리 주소인, 첫 물리 주소를 저장한다. 논리 주소는 프로그램의 시작점으로부터 떨어진 거리이다.

## 메모리 보호 기법

- 다른 프로그램의 메모리 영역을 침범할 수 있는 명령어가 논리 주소 범위를 벗어날 수도 있다. 명령어 실행을 방지하고 실행 중인 프로그램이 다른 프로그램에 영향을 받지 않도록 보호할 방법이 필요한데 이것을 한계 레지스터(limit register) 라는 레지스터가 담당한다.

  ![mod2d4](https://github.com/choidoorim/TIL/assets/63203480/5d9e7eb2-03e7-4cd6-83dd-8392cc1fccfd)

- 한계 레지스터는 논리 주소의 최대 크기를 저장한다. 어떤 프로그램의 물리주소 범위는 `베이스 레지스터 값 ~ 베이스 레지스터 값 + 한계 레지스터 값`이 된다. 그렇기 때문에 CPU 가 접근하려는 논리 주소는 한계 레지스터가 저장한 값보다 커서는 안된다.
- CPU 는 메모리에 접근하기 전에 접근하고자 하는 논리 주소가 한계 레지스터보다 작은지를 항상 검사하고, 만약 높은 논리 주소에 접근하려고 한다면 인터럽트(트랩)를 발생시켜 실행을 중단한다.
