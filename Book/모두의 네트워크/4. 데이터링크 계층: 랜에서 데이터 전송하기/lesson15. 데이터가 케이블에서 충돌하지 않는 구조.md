# lesson15. 데이터가 케이블에서 충돌하지 않는 구조

## 1. 전이중 통신과 반이중 통신

- 전이중 통신 방식은 송신선과 수신선이 각각 있어서 송수신을 동시에 하는 것이다. 따라서 빠르게 데이터를 전송하고, 전송하는 시간을 줄일 수 있다는 장점이 있다. 하지만 복잡한 구성으로 인한 비용이 증가하고, 송수신에 대한 오류를 처리하는 것도 더 복잡하다는 단점이 있다.
    - 오류를 처리하기 힘든 이유는 데이터 전송이 끝나기 전에 오류가 발생할 경우 데이터 전송을 중지하고 재시작해야 한다. 이 과정에서 일부 데이터가 이미 수신된 상태일 수도 있으므로 오류가 발생한 위치를 파악하고 해당 위치 이후부터 데이터를 재전송해야 합니다. 그리고 이런 과정에서 추가적인 대역폭을 소모하게 되고, 전체적인 시간도 더 많이 소요됩니다.

  ![Untitled1](https://user-images.githubusercontent.com/63203480/236621981-33a92c18-9ce1-40b0-abcf-99e5ce52e636.png)

- 반이중 통신 방식은 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식이다. 구성이 단순해서 비용이 저렴하고, 송수신이 분리되어 있기 때문에 오류가 발생한 측만 데이터를 재전송하면 되기 때문에 안정적으로 오류를 처리할 수 있다는 장점이 있다. 반면에 데이터를 동시에 송수신 하지 못하기 때문에 느리고, 데이터 전송량이 적다는 단점이 있다. 만약 반이중 통신 방식에서 동시에 데이터를 전송할 경우에는 충돌이 발생한다.

  허브 내부에는 송수신이 나눠져있지 않기 때문에 동시에 데이터를 보낼 때 충돌이 발생한다. 그렇기 때문에 **허브는 송신과 수신을 번갈아가면서 하는 반이중 통신 방식**을 사용한다.

  ![Untitled2](https://user-images.githubusercontent.com/63203480/236621990-a8d71e8a-6574-4d27-9646-cd58e4e05a59.png)

  반면에 스위치는 충돌이 이뤄지지 않는 구조로 이뤄졌기 때문에 전이중 통신 방식으로도 데이터를 주고 받을 수 있다.

  ![Untitled3](https://user-images.githubusercontent.com/63203480/236622000-f94b7248-0a59-4e29-a4df-8c70508b2107.png)

## 2. 충돌 도메인이란?

- 반이중 통신 방식으로 데이터를 동시에 전송하면 충돌이 발생하는데, **충돌이 발생할 때 그 영향이 미치는 범위를 충돌 도메인(collision domain)** 이라고 한다.
- 허브는 반이중 통신 방식으로 동시에 데이터를 전송하면 충돌이 발생하기 때문에 허브에 연결된 컴퓨터 전체가 충돌 도메인이다. 반면에 스위치는 전이중 통신 방식이기 때문에 충돌 도메인이 각각의 컴퓨터로 비교적 좁아진다.

  ![Untitled4](https://user-images.githubusercontent.com/63203480/236622329-e0691b4a-a074-4e8d-aa35-a946d2d6f40d.png)

- 충돌 도메인이 넓을수록 네트워크가 지연되기 때문에 통신 효율이 스위치가 더 좋다.

## 3. ARP(Address Resolution Protocol)

- 목적지 컴퓨터의 IP 주소(논리주소)를 통해 MAC 주소(물리주소)를 찾기 위한 프로토콜이다. 이더넷 프레임을 전송하기 위해서는 반드시 목적지 컴퓨터의 MAC 주소를 지정해야 한다.
- 출발지 컴퓨터가 목적지 주소를 모를 경우 **MAC 주소를 알아내기 위해서 네트워크에 브로드캐스트를 하는데 이것을 ARP Request** 라고 한다. 만약 **지정된 IP 주소를 가진 컴퓨터가 있다면 MAC 주소를 응답으로 보내고 이것을 ARP Apply** 라고 한다. 결국 출발지 컴퓨터는 MAC 주소를 얻게 되고, 이더넷 프레임을 만들 수 있게 된다.
- 출발지 컴퓨터는 MAC 주소를 얻은 이후에 IP 주소와 MAC 주소의 매핑 정보를 메모리에 보관한다. 이 정보를 ARP Table 이라고 한다. 이후 통신할 때는 ARP 테이블에서 IP 주소와 매핑된 MAC 주소를 참고하여 사용한다.
- IP 주소가 변경되면 MAC 주소도 변경된다. 따라서 ARP 테이블에서는 데이터의 보존기간을 ARP 캐시로 지정하고, 일정 시간이 지나면 삭제되고 다시 ARP 요청을 한다.
- `arp -a` 명령을 통해 ARP 캐시를 확인할 수 있다.

<img width="521" alt="Untitled5" src="https://user-images.githubusercontent.com/63203480/236622343-972ab8d5-023f-4b18-8de8-85a84bd1f9cd.png">
