## :one: TDD BASIC
### Package.json
- í”„ë¡œì íŠ¸ì˜ ì •ë³´ì™€ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘ì¸ íŒ¨í‚¤ì§€ì˜ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•˜ëŠ” ê³³
- ìˆ˜ë™ìœ¼ë¡œ ìž‘ì„±ì´ ê°€ëŠ¥í•˜ê³ , ```npm init``` ì´ë¼ëŠ” ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒì„±ì´ ê°€ëŠ¥í•˜ë‹¤
### Express
- Node.js ì˜ API ë“¤ì„ ë‹¨ìˆœí™”í•˜ê³ , ìœ ìš©í•œ ê¸°ëŠ¥ë“¤ì„ ë” ì¶”ê°€ ì‹œì¼œì„œ íŽ¸ë¦¬í•˜ê³  ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìžˆê²Œ í•´ì£¼ëŠ” ëª¨ë“ˆ
### Mongoose
- MongoDBë¥¼ íŽ¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê²Œ í•´ì£¼ëŠ” ë…¸ë“œì˜ í™•ìž¥ ëª¨ë“ˆ
### Jest, node-mocks-http, supertest
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ëª¨ë“ˆ
### npm install ëª¨ë“ˆëª… -dev
- ì„¤ì¹˜í•˜ëŠ” ëª¨ë“ˆëª…ì€ ê°œë°œí™˜ê²½ì—ì„œë§Œ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸
- dev ê°€ ì—†ëŠ” ê²ƒì€ ê°œë°œí™˜ê²½ ì™¸ ìš´ì˜í™˜ê²½ì—ì„œë„ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸, ì–´í”Œë¦¬ì¼€ì´ì…˜ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ëª¨ë“ˆ
### express.json()
- post ìš”ì²­ ì‹œ client ë¡œ ë¶€í„° ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìžˆê²Œ í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.
- express 4.16.0 ë¶€í„°ëŠ” ê¸°ì¡´ bodyParser ëª¨ë“ˆì„ ëŒ€ì²´í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.
- ```app.use(express.json());```
### ê¸°ëŠ¥ ë³„ë¡œ í´ë”ë¥¼ ë‚˜ëˆ„ì–´ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ë° ê°œë°œì— ì¢‹ë‹¤ (Route, Controller, Dao..)
- express.Router í´ëž˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ Router ë¥¼ ëª¨ë“ˆë¡œ ìž‘ì„±í•  ìˆ˜ ìžˆë‹¤
```javascript
// index.js
const userRoute = require('../src/app/Test/testRoute');
app.use('/app/user', userRoute)
```
```javascript
// route.js
router.post('/product', (req, res) => {
    const {pdName} = req.body
    console.log(`req body : ${pdName}`)
    res.send(pdName);
});

module.exports = router;
```
- index.js ì—ì„œ ë¼ìš°í„° ëª¨ë“ˆì„ ë§ˆìš´íŠ¸í•¨ìœ¼ë¡œì¨ route.js ì—ì„œëŠ” ```/product``` ë§Œ ìž‘ì„±í•˜ì—¬ë„ ```/app/user/product``` ì™€ ë™ì¼í•œ ê²ƒì´ë‹¤
### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëž€?
- ê°œë°œìžê°€ ìˆ˜í–‰í•˜ê³  ìžì‹ ì´ ê°œë°œ í•œ ì½”ë“œ ë‹¨ìœ„ë¥¼ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²ƒ
- ì†ŒìŠ¤ ì½”ë“œì˜ ê°œë³„ ë‹¨ìœ„ë¥¼ í…ŒìŠ¤íŠ¸í•˜ì—¬ ì‚¬ìš©ì´ ê°€ëŠ¥í•œì§€ë¥¼ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ ë°©ë²•ì´ë‹¤.
#### ë‹¨ìœ„(Unit) í…ŒìŠ¤íŠ¸ì˜ ì¡°ê±´
1. ë…ë¦½ì ì´ì–´ì•¼ í•˜ë©°, ì–´ë–¤ í…ŒìŠ¤íŠ¸ë„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜ì¡´í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.
2. Ajax, Axios, LocalStorageë“± í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì˜ì¡´í•˜ëŠ” ê²ƒì€ ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ëŒ€ì²´í•˜ì—¬ ê²©ë¦¬ì‹œì¼œì•¼ í•œë‹¤.
#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì™œ í•´ì•¼í• ê¹Œ?
1. ì‹¤ì œ ì„œë¹„ìŠ¤ ê°™ì€ ê²½ìš°ì—ëŠ” í”„ë¡œê·¸ëž¨ì´ í¬ê³ , ë©”ëª¨ë¦¬ê°€ ë§Žì´ ë“¤ë©°, DB ë“±ì´ í•„ìš”í•  ê²½ìš° ë¡œì»¬ í™˜ê²½ì—ì„œ ì‰½ê²Œ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œì¼œë³´ê¸° ì–´ë µê¸° ë•Œë¬¸ì´ë‹¤.
   ë”°ë¼ì„œ ìœ ë‹›í…ŒìŠ¤íŠ¸(=ë‹¨ìœ„í…ŒìŠ¤íŠ¸)ë¥¼ í†µí•´ ë¹ ë¥´ê²Œ ìžì‹ ì˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ë™ìž‘í•˜ëŠ”ì§€ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.
2. ì¢…ì†ì„±ì´ ìžˆëŠ” ë‹¤ë¥¸ í´ëž˜ìŠ¤ë“¤ì—ì„œ ë²„ê·¸ê°€ ë‚˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìžˆë‹¤.
- A í´ëž˜ìŠ¤ ì™€ C í´ëž˜ìŠ¤ì—ì„œ ê³µë™ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” Common Class ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ A í´ëž˜ìŠ¤ ì˜ Common Class ë¥¼ ê³ ì¹˜ë‹¤ë³´ë‹ˆ C í´ëž˜ìŠ¤ì—ì„œ ë§žì§€ ì•ŠëŠ” í´ëž˜ìŠ¤ë¥¼ ê³ ì³ë²„ë ¤ì„œ
  C í´ëž˜ìŠ¤ì— ìˆ˜ì •ì´ ë“¤ì–´ê°€ê³ , ì´ë ‡ê²Œ ë˜ë©´ ë˜ ë‹¤ì‹œ A í´ëž˜ìŠ¤ì—ì„œ ë‹¤ì‹œ ì—ëŸ¬ê°€ ìƒê¸¸ ê°€ëŠ¥ì„±ì´ í¬ë‹¤.
- ìœ„ì™€ ê°™ì€ ìƒí™©ì—ì„œ ìœ ë‹› í…ŒìŠ¤íŠ¸ë¥¼ í•  ê²½ìš°ì— ì–´ë–¤ ë¶€ë¶„ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê²Œ ë˜ëŠ”ì§€ ë¹¨ë¦¬ ì•Œ ìˆ˜ ìžˆê²Œ ë˜ë©°, ì œëŒ€ë¡œ ë²„ê·¸ë¥¼ ìž¡ì„ ìˆ˜ ìžˆë‹¤.

### Jest
- FaceBook ì—ì„œ ë§Œë“  í…ŒìŠ¤íŒ… í”„ë ˆìž„ì›Œí¬ë¡œ ìµœì†Œí•œì˜ ì„¤ì •ìœ¼ë¡œ ë™ìž‘í•˜ë©°, Test Case ë¥¼ ë§Œë“¤ì–´ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œê°€
ìž˜ ëŒì•„ê°€ëŠ”ì§€ í™•ì¸í•´ì¤€ë‹¤
- ìœ ë‹› í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆì´ë‹¤
```javascript
"test": "echo \"Error: no test specified\" && exit 1"
```
- package.json íŒŒì¼ì— ìžˆëŠ” script ë¶€ë¶„ì„ ìœ„ì—ì„œ ì•„ëž˜ì™€ ê°™ì´ ìˆ˜ì •í•œë‹¤
```javascript
"test": "jest" // jest --watchAll 
```
- ```npm test``` : test ì½”ë“œë¥¼ ì°¾ì•„ì„œ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤
#### jest ê°€ test íŒŒì¼ì„ ì°¾ëŠ” ë²•
1. {filename}.test.js
2. {filename}.spec.js
3. tests ë¼ëŠ” í´ë” ë‚´ì— ìžˆëŠ” ëª¨ë“  íŒŒì¼ë“¤
#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ í†µí•© í…ŒìŠ¤íŠ¸
```bash
ðŸ“‚ test
 â””â”€â”€ ðŸ“‚ integration 
      â”œâ”€â”€ ðŸ“„products.int.test.js
 â””â”€â”€ ðŸ“‚ unit 
      â”œâ”€â”€ ðŸ“„products.test.js
```
#### Jest íŒŒì¼ êµ¬ì¡° ë° ì‚¬ìš©ë²•
- describe ì•ˆì— test case ë“¤ì„ ê°ê° ë„£ì–´ì£¼ëŠ” ë°©ì‹ì´ë‹¤
- describe : ì—¬ëŸ¬ ê´€ë ¨ëœ í…ŒìŠ¤íŠ¸ë“¤ì„ ê·¸ë£¹í™”í•˜ëŠ” ë¸”ë¡ì„ ë§Œë“œëŠ” ê²ƒì´ë‹¤ ```describe(name, function)```
- it or test : ê°œë³„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê³³ìœ¼ë¡œ ê° í…ŒìŠ¤íŠ¸ë¥¼ ìž‘ì€ ë¬¸ìž¥ì²˜ëŸ¼ ì„¤ëª…í•œë‹¤ ```it(name, function, timeout)```
- expect : ê°’ì„ í…ŒìŠ¤íŠ¸í•  ë•Œë§ˆë‹¤ ì‚¬ìš©ëœë‹¤. í˜¼ìžì„œëŠ” ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©´ matcher ì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤.
- matcher : expect ì•ˆì— ìžˆëŠ” ê°’ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œ toBeTruthy(), toBeCalledWith() ë“± ì—¬ëŸ¬ë°©ë²•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
```javascript
decribe("ê³¼ì¼", () => {
    beforEach(() => {
        // source
    })
    it("ì‚¬ê³¼", () => {
        // expect <=> matcher
    });
    it("ë©œë¡ ", () => {
        // expect <= matcher
    });
    .
    .
    .
});
```
### Jest.fn()
- Mock í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.
- mock ì´ëž€ ëª¨ì˜ ê³ ì‚¬ì˜ ëª¨ì˜ë¼ëŠ” ëœ»ì´ ìžˆìœ¼ë©°, ê°€ì§œ í‰ë‚´ë‚´ëŠ” ì´ëŸ¬í•œ ëœ»ì´ ìžˆë‹¤.
- Mock í•¨ìˆ˜ê°€ í•˜ëŠ” ì¼ì€ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìž‘ì„±í•  ë•Œ, í•´ë‹¹ ì½”ë“œê°€ ì˜ì¡´í•˜ëŠ” ë¶€ë¶„ì„ ê°€ì§œë¡œ ëŒ€ì²´í•˜ëŠ” ì¼ì„ í•œë‹¤.
#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì™œ ë…ë¦½ì ì´ì–´ì•¼ í• ê¹Œ?
- ì˜ì¡´ì ì¸ ë¶€ë¶„ì„ êµ¬í˜„í•˜ê¸°ê°€ ê¹Œë‹¤ë¡œìš¸ ìˆ˜ ìžˆê³ , ì˜ì¡´ì ì¸ ë¶€ë¶„ì˜ ìƒíƒœì— ë”°ë¼ì„œ í…ŒìŠ¤íŠ¸í•˜ê³ ìž í•˜ëŠ” ë¶€ë¶„ì˜
í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì˜í–‰ì„ ë°›ì„ ìˆ˜ ìžˆê¸° ë•Œë¬¸ì´ë‹¤.
- ```jest.fn()``` ì„ ì´ìš©í•´ì„œ ê°€ì§œ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ì—¬ ì˜ì¡´ì ì¸ ë¶€ë¶„ìœ¼ë¡œ ì¸í•´ ì˜í–¥ì„ ë°›ëŠ” í…ŒìŠ¤íŠ¸ ìƒí™©ì„ í•´ê²° í•  ìˆ˜ ìžˆë‹¤.
- ```jest.fn()``` ì´ ìƒì„±í•œ ê°€ì§œ í•¨ìˆ˜ëŠ” ì–´ë–¤ ì¼ì´ ë°œìƒí–ˆëŠ”ì§€, ë‹¤ë¥¸ ì½”ë“œë“¤ì— ì˜í•´ì„œ ì–´ë–»ê²Œ í˜¸ì¶œë˜ëŠ”ì§€ë¥¼
ê¸°ì–µí•˜ê¸° ë•Œë¬¸ì— ì´ í•¨ìˆ˜ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ ê²€ì¦í•  ìˆ˜ë„ ìžˆë‹¤.

#### Example - Node ì—ì„œ DB ì— ë°ì´í„°ë¥¼ ì „ì†¡ ì‹œ
- ë°ì´í„°ë¥¼ ì „ì†¡ ì‹œ : Network, I/O ìž‘ì—…, íŠ¸ëž™ìž­ì…˜ ìƒì„±, ì¿¼ë¦¬ ì „ì†¡ ë“±..
- ë°ì´í„°ë¥¼ ì „ì†¡ í›„ : ë³€ê²½ ë°ì´í„°ë¥¼ ì§ì ‘ ì›ë³µí•˜ê±°ë‚˜, íŠ¸ëžœìž­ì…˜ Rollback ë“±..
- ìœ„ì˜ ì—¬ëŸ¬ ê²½ìš°ë“¤ ë•Œë¬¸ì— ë°ì´í„°ë¥¼ ì €ìž¥í•˜ëŠ” ë¶€ë¶„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ ë„ˆë¬´ë‚˜ ë§Žì€ ìž‘ì—…ì´ ë“¤ì–´ê°€ ë¹„íš¨ìœ¨ì ì´ë‹¤.
- ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê°€ìš´ë° DB ê°€ ë¬¸ì œê°€ ìžˆë‹¤ë©´ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì—ë„ ì˜í–¥ì„ ë¯¸ì¹˜ê²Œ ë©ë‹ˆë‹¤.

 