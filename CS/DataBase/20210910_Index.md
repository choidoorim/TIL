> **Index 란?**

추가적인 쓰기 작업과 **저장 공간을 활용하여 데이터베이스 테이블의 검색속도를 향상**시키기 위한 자료구조 입니다.

우리가 책에서 원하는 내용을 찾는다고 가정하면 책의 모든 페이지를 찾아보는 것은 비효율적입니다. 그렇기 때문에 책의 저자들을 맨 앞이나 뒤에 색인(목차)이라는 것을 추가하는데, Index는 책의 색인과 같습니다.

![1](https://user-images.githubusercontent.com/63203480/132804500-84edef71-dd7c-478f-8137-70e804f6f942.png)

인덱스를 활용하면 데이터를 조회하는 작업 외에도 UPDATE, DELETE의 성능이 함께 향상됩니다. 해당 연산들을 수행하기 위해서는 대상을 조회하는 작업이 필수이기 때문입니다.

즉, 데이터베이스 안의 레코드를 처음부터 풀스캔하지 않고, B+ Tree로 구성된 구조에서 Index 파일 검색으로 속도를 향상시키는 기술입니다.

하지만 이런 Index도 검색 속도 향상이라는 장점도 있지만 단점도 존재합니다.

> **Index 장단점**

**1. 장점**

-   테이블을 조회하는 속도와 그에 따른 성능을 향상시킬 수 있습니다.
-   전반적인 시스템의 부하를 줄일 수 있습니다.

**2. 단점**

-   인덱스를 관리하기 위해서 DB의 약 10%에 해당하는 저장공간이 필요합니다.
-   인덱스를 관리하기 위한 추가적인 작업을 필요로 합니다.
-   데이터 변경 작업이 자주 일어나는 경우에 Index를 재작성해야 하므로 성능에 영향을 미칩니다.
-   한 페이지를 동시에 수정할 수 있는 병행성이 줄어듭니다.

만약 CREATE, DELETE, UPDATE가 빈번한 속성에 Index를 걸게된다면 Index의 크기가 커지게되어 오히려 성능이 저하되는 역효과가 발생할 수 있습니다. 만약 UPDATE와 DELETE가 빈번하게 발생되는 테이블이라면 실제 데이터가 10만건일 때 인덱스는 100만 건이 넘어가게 되어, SQL문 처리 시 비대해진 인덱스에 의해 오히려 성능이 저하됩니다.

1. 사용하면 좋은 경우

-   JOIN, WHERE 또는 ORDER BY절에서 자주 사용되는 컬럼
-   규모가 작지 않은 테이블
-   DML(INSERT, UPDATE, DELETE)이 자주 발생하지 않은 컬럼
-   데이터의 중복도가 낮은 컬럼

2. 사용하면 좋지 않은 경우

-   DML이 자주 일어나는 컬럼
-   데이터 중복도가 높은 컬럼

> **DML 시 인덱스 관리**

DBMS는 Index를 항상 최신의 정렬된 상태로 유지해야 원하는 값을 빠르게 탐색할 수 있습니다. 그렇기 때문에 인덱스가 적용된 컬럼에 **DML이 수행**된다면 아래와 같은 연산이 추가되어 이에 대한 **오버헤드가 발생**합니다.

-   INSERT : 새로운 데이터에 대한 인덱스를 추가
-   DELETE : 삭제하는 데이터의 인덱스를 사용하지 않는다는 작업을 진행
-   UPDATE : 기존의 인덱스를 사용하지 않음 처리 후, 갱신된 데이터에 대해 **인덱스를 추가**

> **DML이 일어났을 때의 상황 예시**

1. INSERT

기존 Block에 여유가 없을 때, 새로운 Data가 입력되는 경우

-   새로운 Block을 할당 받은 후, Key를 옮기는 작업 수행
-   인덱스를 나누는 작업을 하는 동안, 해당 Block의 Key 값에 대해서 DML이 Blocking 되어 대기이벤트가 발생

2. DELETE

-   테이블에서 데이터가 DELETE 되는 경우: Data가 지워지고, 다른 Data가 그 공간을 사용할 수 있다.
-   인덱스에서 데이터가 DELETE 되는 경우: Data가 지워지고, 사용 안 됨 표시만 해준다.

따라서 Table의 데이터 수와 Index의 데이터 수가 다를 수 있습니다.

3. UPDATE

-   Table 에서 Update가 발생하게되면 Index는 Update를 할 수 없습니다.
-   UPDATE가 아닌 Index에서는 Delete 를 한 후, 새로운 작업의 Insert 작업을 합니다. 즉, 2배의 작업이 소요되어 힘듭니다.

> **파일 구성**

테이블을 생성하게 되면, 3가지의 파일이 생성됩니다.

1.  FRM : 테이블 구조를 저장하는 파일
2.  MYD : 실제 데이터 파일
3.  MYI : Index 정보를 저장하는 파일(Index 사용 시 생성)

사용자가 쿼리를 통해 Index를 사용하는 컬럼을 검색하게 되면, 이때 MYI 파일의 내용을 활용하게 됩니다.